<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Palatino Linotype:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/blog/lib/pace/pace-theme-center-atom.min.css">
  <script src="/blog/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"weowang.github.io","root":"/blog/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Weo Wang&#39;s Der Bau">
<meta property="og:url" content="https://weowang.github.io/blog/index.html">
<meta property="og:site_name" content="Weo Wang&#39;s Der Bau">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Weo Wang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://weowang.github.io/blog/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Weo Wang's Der Bau</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Weo Wang's Der Bau</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://weowang.github.io/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Weo Wang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weo Wang's Der Bau">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/" class="post-title-link" itemprop="url">Study S32K3 from Scratch - Software Triggered ADC in Scan Mode (MCAL Version)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-01-22 15:21:00 / Modified: 22:27:45" itemprop="dateCreated datePublished" datetime="2022-01-22T15:21:00+08:00">2022-01-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>Who is this article for?</strong><br>For people who wants to start S32K3 development.<br><strong>What is this article about?</strong><br>In this article, we may not spend too much time on the details of S32K3. Instead, we will configure and debug different applications which utilize different peripherals, learning by doing it is the main theme of my articles.<br><strong>Why do I write this article?</strong><br>I struggled a lot at the beginning of learning embedded development, so I hope my articles can help people like me as a green hand, and they are also records of my self-teaching.</p>
<h2 id="Build-Developing-Environment"><a href="#Build-Developing-Environment" class="headerlink" title="Build Developing Environment"></a>Build Developing Environment</h2><p>If we want to develop our applications on S32K3xx with MCAL, we need S32K3 Real-Time Drivers for Cortex-M, S32 Design Studio 3.4, and EB Tresos Studio 27.1.0, we can download them in the link below:<br><a target="_blank" rel="noopener" href="https://www.nxp.com/products/processors-and-microcontrollers/arm-microcontrollers/s32k-automotive-mcus/s32k3-microcontrollers-for-general-purpose:S32K3">S32K3 Microcontrollers for General Purpose</a><br>If you encounter problems, please contact NXP’s Account Managers or Technical Sale Representatives for help.</p>
<h3 id="S32K3-Real-Time-Drivers-for-Cortex-M"><a href="#S32K3-Real-Time-Drivers-for-Cortex-M" class="headerlink" title="S32K3 Real-Time Drivers for Cortex-M"></a>S32K3 Real-Time Drivers for Cortex-M</h3><p>We can find S32K3 Real-Time Drivers for Cortex-M in the link above, it’s recommended to install it in the default path:</p>
<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p1.png" class="" title="This is an example image">

<h3 id="S32-Design-Studio-3-4"><a href="#S32-Design-Studio-3-4" class="headerlink" title="S32 Design Studio 3.4"></a>S32 Design Studio 3.4</h3><p>If we choose MCAL architecture for developing, S32 Design Studio is only for compiling and debugging, thus we don’t need the internal development package for S32K3, but we still recommend to install the latest S32K3 development package, in case you want to use RTD-LLD for developing one day. There is one thing that we should pay attention, it requires GCC 10.2 for compiling:</p>
<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p2.png" class="" title="This is an example image">
<p>If your GCC version is not 10.2, you can install it in S32 Design Studio’s Help -&gt; S32DS Extensions and Updates:</p>
<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p3.png" class="" title="This is an example image">

<h3 id="EB-Tresos-27-1"><a href="#EB-Tresos-27-1" class="headerlink" title="EB Tresos 27.1"></a>EB Tresos 27.1</h3><p>We can download EB Tresos 27.1 and get the license in the link provided above.</p>
<h3 id="Developing-Environment’s-Verification"><a href="#Developing-Environment’s-Verification" class="headerlink" title="Developing Environment’s Verification"></a>Developing Environment’s Verification</h3><h4 id="Code-Generating-in-EB-Tresos-27-1"><a href="#Code-Generating-in-EB-Tresos-27-1" class="headerlink" title="Code Generating in EB Tresos 27.1"></a>Code Generating in EB Tresos 27.1</h4><p>Here I provide a template project to help users accelerate their evaluating:<br><a target="_blank" rel="noopener" href="https://github.com/weowang/mcal_template_project">Github - mcal_template_project</a><br>If the developing environment is built, we can import the template project for testing. First of all we need to import Tresos project in EB:<br>File -&gt; Import -&gt; General -&gt; Existing Projects into Workspace</p>
<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p4.png" class="" title="This is an example image">
<p>Choose the template project, and import the Tresos project inside it:</p>
<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p5.png" class="" title="This is an example image">
<p>Double click “someId(CORTEXM, S32K3XX)” to load the module list:</p>
<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p6.png" class="" title="This is an example image">
<p>Click “Generate code for the currently selected projects” (little hammer) to generate code:</p>
<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p7.png" class="" title="This is an example image">
<p>Here we’ve finished the code generating in EB Tresos 27.1.</p>
<h4 id="Project-Compiling-in-S32-Design-Studio-3-4"><a href="#Project-Compiling-in-S32-Design-Studio-3-4" class="headerlink" title="Project Compiling in S32 Design Studio 3.4"></a>Project Compiling in S32 Design Studio 3.4</h4><p>Click File -&gt; Import -&gt; General -&gt; Existing Projects into Workspace to import the template project, if the RTD is installed in the default path, we don’t need to do anything, but if the RTD is installed in other paths, we need to change some settings:</p>
<ol>
<li>Change the link path of MCAL plugins - right-click the template project, choose Properties -&gt; Resource -&gt; Linked Resources -&gt; Linked Resources -&gt; Absolute Path Location -&gt; Link_Source, and replace the path of MCAL plugins with the actual path;<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p8.png" class="" title="This is an example image"></li>
<li>Change the MCAL plugins’ compiling path - right-click the template project, choose Properties -&gt; C/C++ Build -&gt; Build Variables -&gt; MCAL_PLUGIN_PATH, replace it with the actual MCAL plugins path.<img src="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/p9.png" class="" title="This is an example image"></li>
</ol>
<p>Click the “Build” button to compile the template project, if everything goes well, “Build Finished. 0 errors, 0 warnings.” should be printed in the Console window, which indicates that the developing environment is successfully built.</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/01/22/Study-S32K3-From-Scratch-Software-Triggered-ADC-In-Scan-Mode-MCAL-Version/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://weowang.github.io/blog/2022/01/02/Tips-for-S32K3's-ADC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Weo Wang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weo Wang's Der Bau">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/01/02/Tips-for-S32K3's-ADC/" class="post-title-link" itemprop="url">Tips for S32K3's ADC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-01-02 21:05:00" itemprop="dateCreated datePublished" datetime="2022-01-02T21:05:00+08:00">2022-01-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-12 11:16:17" itemprop="dateModified" datetime="2022-01-12T11:16:17+08:00">2022-01-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ADC-Conversion-Resolution’s-Configuration-in-DMA-Mode"><a href="#ADC-Conversion-Resolution’s-Configuration-in-DMA-Mode" class="headerlink" title="ADC Conversion Resolution’s Configuration in DMA Mode"></a>ADC Conversion Resolution’s Configuration in DMA Mode</h2><h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>As we know, there are 3 types of ADC channels on the S32K3xx series: Precision, Standard, and External, they have different accuracy and performance level, we can get the types of ADC channels by checking the Reference Manual.</p>
<img src="/blog/2022/01/02/Tips-for-S32K3's-ADC/P1.png" class="" title="This is an example image">
<img src="/blog/2022/01/02/Tips-for-S32K3's-ADC/P2.png" class="" title="This is an example image">
<img src="/blog/2022/01/02/Tips-for-S32K3's-ADC/P3.png" class="" title="This is an example image">
<p>Normally, the conversion result can be processed automatically according to the resolution that we select in the ADC module’s configuration. While, if we use DMA to transfer conversion results, we need to process the conversion results manually. Currently, there is no explanation about this step, so I hope my article can help people who have the same questions when using DMA to transfer ADC conversion results.</p>
<h3 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h3><p>According to the Reference Manual, the conversion resolution can be modified by setting CALBISTREG[RESN], reducing the conversion resolution speeds up the conversion because the SAR algorithm executes fewer steps:</p>
<img src="/blog/2022/01/02/Tips-for-S32K3's-ADC/P4.png" class="" title="This is an example image">
<p>But we need to pay attention, the conversion result is always 15 bits wide, even the selected resolution is smaller than 15 bits, I often call it “Raw Data”. </p>
<img src="/blog/2022/01/02/Tips-for-S32K3's-ADC/P5.png" class="" title="This is an example image">
<p>Thus, the conversion result needs to be processed accordingly. For example, if the Adc Result Alignment is ADC_ALIGN_RIGHT(usually default), and the content in ICDR/PCDR’s 15-0(CDATA) is 0x31B:<br><code>0000 0011 0001 1011</code>,<br>The data occupies xCDR[14:0], the Raw Data should be:<br> <code>000 0011 0001 1011</code>,<br>Considering the physical characteristics of different types of ADC channels, we recommend RESOLUTION_10 for Standard channels and RESOLUTION_12 for Precision channels. </p>
<img src="/blog/2022/01/02/Tips-for-S32K3's-ADC/P6.png" class="" title="This is an example image">
<p>If the ADC channel is Precision, the Raw Data should be converted from 15 bits to 12 bits:<br> <code>000 0011 0001 1011</code> &gt;&gt; 3<br>-&gt;<br> <code>0000 0110 0011</code>;<br>If we don’t use DMA to transfer conversion results, this step is implemented automatically:</p>
<p>For example, in RTD-LLD’s source code:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*FUNCTION*********************************************************************</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function Name : Adc_Sar_GetMaskedResult</span></span><br><span class="line"><span class="comment"> * Description   : Returns result masked accordingly with alignment</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *END*************************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> uint16 <span class="title">Adc_Sar_GetMaskedResult</span><span class="params">(<span class="keyword">const</span> uint32 Instance,</span></span></span><br><span class="line"><span class="params"><span class="function">                                             <span class="keyword">const</span> uint32 Cdr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    uint32 CdrMask = ADC_CDR_CDATA_MASK;</span><br><span class="line">    uint16 Result;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> (ADC_SAR_IP_SET_RESOLUTION == STD_ON)</span></span><br><span class="line">    uint8 Resolution;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    uint8 Resolution = ADC_MAX_RESOLUTION;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* (ADC_SAR_IP_SET_RESOLUTION == STD_ON) */</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> (ADC_SAR_IP_SET_RESOLUTION == STD_ON)</span></span><br><span class="line">    <span class="keyword">if</span> (FALSE == aAdcSarState[Instance].bBypassResolution)</span><br><span class="line">    &#123;</span><br><span class="line">        Resolution = Adc_Sar_GetResolution(Instance);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Resolution = ADC_RESULT_RESOLUTION;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* (ADC_SAR_IP_SET_RESOLUTION == STD_ON) */</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* If the result is left aligned, adjust register mask accordingly */</span></span><br><span class="line">    <span class="keyword">if</span> (aAdcSarState[Instance].eDataAlign == ADC_SAR_IP_DATA_ALIGNED_LEFT)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* Assumption: the width of the register is less than 16 */</span></span><br><span class="line">        CdrMask = (uint32)ADC_CDR_CDATA_MASK &lt;&lt; (<span class="number">16u</span> - Resolution);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> (ADC_SAR_IP_SET_RESOLUTION == STD_ON)</span></span><br><span class="line">        Result = ((uint16)(Cdr &amp; CdrMask)) &gt;&gt; ADC_CDR_CDATA_SHIFT;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* (ADC_SAR_IP_SET_RESOLUTION == STD_ON) */</span></span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> (ADC_SAR_IP_SET_RESOLUTION == STD_ON)</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        CdrMask = ((uint32)ADC_CDR_CDATA_MASK &gt;&gt; <span class="number">1u</span>) &amp; ((uint32)ADC_CDR_CDATA_MASK &lt;&lt; (ADC_RESULT_RESOLUTION - Resolution));</span><br><span class="line">        Result = ((uint16)(Cdr &amp; CdrMask)) &gt;&gt; (ADC_RESULT_RESOLUTION - Resolution + ADC_CDR_CDATA_SHIFT);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    Result = ((uint16)(Cdr &amp; CdrMask)) &gt;&gt; ADC_CDR_CDATA_SHIFT;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* (ADC_SAR_IP_SET_RESOLUTION == STD_ON) */</span></span></span><br><span class="line">    <span class="keyword">return</span> Result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>While if using DMA to transfer, the conversion result we get is the so-called “Raw Data”, thus we need to convert them by ourselves.</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2022/01/02/Tips-for-S32K3's-ADC/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://weowang.github.io/blog/2021/10/06/Study-S32K3-From-Scratch-BCTU/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Weo Wang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weo Wang's Der Bau">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/10/06/Study-S32K3-From-Scratch-BCTU/" class="post-title-link" itemprop="url">Study S32K3 From Scratch - BCTU</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-10-06 13:07:00" itemprop="dateCreated datePublished" datetime="2021-10-06T13:07:00+08:00">2021-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-08 15:55:55" itemprop="dateModified" datetime="2022-01-08T15:55:55+08:00">2022-01-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>Who is this article for?</strong><br>For people who wants to start S32K3 development.<br><strong>What is this article about?</strong><br>In this article, we may not spend too much time on the details of S32K3. Instead, we will configure and debug different applications which utilize different peripherals, learning by doing it is the main theme of my articles.<br><strong>Why do I write this article?</strong><br>I struggled a lot at the beginning of learning embedded development, so I hope my articles can help people like me as a green hand, and they are also records of my self-teaching.</p>
<h2 id="Introduction-of-BCTU-Module"><a href="#Introduction-of-BCTU-Module" class="headerlink" title="Introduction of BCTU Module"></a>Introduction of BCTU Module</h2><p>BCTU is the abbreviation of Body Cross-Triggering Unit, it accepts ADC conversion-request trigger inputs and routes those requests to one or more ADCs, there are two types of trigger sources:</p>
<h3 id="Hardware-triggers-72-Trigger-Sources"><a href="#Hardware-triggers-72-Trigger-Sources" class="headerlink" title="Hardware triggers(72 Trigger Sources)"></a>Hardware triggers(72 Trigger Sources)</h3><ul>
<li>69 eMIOS Trigger Sources</li>
<li>3 TRGMUX Trigger Sources</li>
</ul>
<h3 id="Software-triggers-SFTRGRn"><a href="#Software-triggers-SFTRGRn" class="headerlink" title="Software triggers(SFTRGRn)"></a>Software triggers(SFTRGRn)</h3>
<p>BCTU doesn’t work in STANDBY mode.</p>
<h2 id="Conversion-Mode"><a href="#Conversion-Mode" class="headerlink" title="Conversion Mode"></a>Conversion Mode</h2><p>There are 2 conversion modes:</p>
<ul>
<li>Single Mode – Only 1 channel will be triggered</li>
<li>LIST Mode – More than 1 channels can be triggered even they are from different ADC Instances(MPC, Multiple Parallel Conversions)</li>
</ul>
<h2 id="Trigger-Mechanism"><a href="#Trigger-Mechanism" class="headerlink" title="Trigger Mechanism"></a>Trigger Mechanism</h2><h3 id="Trigger-Timing"><a href="#Trigger-Timing" class="headerlink" title="Trigger Timing"></a>Trigger Timing</h3><p>There are 4 clock cycles between a BCTU trigger input’s assertion to a ADC trigger output’s assertion.</p>
<img src="/blog/2021/10/06/Study-S32K3-From-Scratch-BCTU/P2.png" class="" title="This is an example image">
<p>BCTU will generate a CLR[n] signal to clear the input trigger signal, at the same time, it will generate a signal to trigger the ADC.</p>
<h3 id="Priority-Management"><a href="#Priority-Management" class="headerlink" title="Priority Management"></a>Priority Management</h3><p>If two or more trigger signals are inputted into BCTU at the same clock cycle, the lower the trigger input number, the higher is the priority, for example, TRG[0] &gt; TRG[1].</p>
<img src="/blog/2021/10/06/Study-S32K3-From-Scratch-BCTU/P3.png" class="" title="This is an example image">
<p>When a trigger input asserts a conversion request to an ADC that is already processing a conversion requested by a different trigger, the new trigger remains active (pending) until the conversion in progress completes. This behavior is the same as if the two triggers had been simultaneous (occurred in the same clock cycle). When the in-progress conversion completes, the pending trigger then competes for priority with any other active trigger for that ADC. </p>
<h2 id="Example-Projects"><a href="#Example-Projects" class="headerlink" title="Example Projects"></a>Example Projects</h2><h3 id="BCTU-Software-Single-Trigger"><a href="#BCTU-Software-Single-Trigger" class="headerlink" title="BCTU Software Single Trigger"></a>BCTU Software Single Trigger</h3><p>In this example, we will use BCTU to trigger a single channel of ADC0(ADC0_48), the input trigger signal is generated by software. </p>
<img src="/blog/2021/10/06/Study-S32K3-From-Scratch-BCTU/P4.png" class="" title="This is an example image">
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2021/10/06/Study-S32K3-From-Scratch-BCTU/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://weowang.github.io/blog/2021/09/25/Study-S32K3-From-Scratch-ADC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Weo Wang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Weo Wang's Der Bau">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/09/25/Study-S32K3-From-Scratch-ADC/" class="post-title-link" itemprop="url">Study S32K3 From Scratch - ADC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-25 22:12:04" itemprop="dateCreated datePublished" datetime="2021-09-25T22:12:04+08:00">2021-09-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-02 18:43:34" itemprop="dateModified" datetime="2022-01-02T18:43:34+08:00">2022-01-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>Who is this article for?</strong><br>For people who wants to start S32K3 development.<br><strong>What is this article about?</strong><br>In this article, we may not spend too much time on the details of S32K3. Instead, we will configure and debug different applications which utilize different peripherals, learning by doing it is the main theme of my articles.<br><strong>Why do I write this article?</strong><br>I struggled a lot at the beginning of learning embedded development, so I hope my articles can help people like me as a green hand, and they are also records of my self-teaching.</p>
<h2 id="Introduction-of-ADC-Module"><a href="#Introduction-of-ADC-Module" class="headerlink" title="Introduction of ADC Module"></a>Introduction of ADC Module</h2><p>There 3 instances of SAR-ADC module on S32K3X4, each module has 3 groups of ADC channels:</p>
<img src="/blog/2021/09/25/Study-S32K3-From-Scratch-ADC/p1.png" class="" title="This is an example image">
<p>Details:</p>
<img src="/blog/2021/09/25/Study-S32K3-From-Scratch-ADC/p2.png" class="" title="This is an example image">

<h2 id="Conversion-Mode"><a href="#Conversion-Mode" class="headerlink" title="Conversion Mode"></a>Conversion Mode</h2><p>There are 3 conversion modes:</p>
<h3 id="Normal-–-supports-One-Shot-and-Scan-conversions"><a href="#Normal-–-supports-One-Shot-and-Scan-conversions" class="headerlink" title="Normal – supports One-Shot and Scan conversions"></a>Normal – supports One-Shot and Scan conversions</h3><p>One-Shot Mode - a sequential conversion is performed only once</p>
<img src="/blog/2021/09/25/Study-S32K3-From-Scratch-ADC/p3.png" class="" title="This is an example image">
<p>Scan Mode - a sequential conversion is performed continuously</p>
<img src="/blog/2021/09/25/Study-S32K3-From-Scratch-ADC/p4.png" class="" title="This is an example image">
<p>When a single conversion is completed, the EOC flag is set and the End of Conversion(EOC) interrupt is issued(if enabled in MSKEOC); when a conversion chain is completed(the last conversion in the chain is completed), the ECH flag is set and End of Chain(ECH) interrupt is issued(if enabled in MSKECH).</p>
<h3 id="Injected-–-supports-One-Shot-Conversion-only"><a href="#Injected-–-supports-One-Shot-Conversion-only" class="headerlink" title="Injected – supports One-Shot Conversion only"></a>Injected – supports One-Shot Conversion only</h3><p>The Injected Conversion can only be inserted into an ongoing conversion chain processed in Normal Conversion Mode.<br>When a single conversion is completed, the End of Injected Conversion(JEOC) interrupt is issued; when a injected conversion chain is completed, the End of Injected Chain(JECH) interrupt is issued.</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/2021/09/25/Study-S32K3-From-Scratch-ADC/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Weo Wang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Weo Wang</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/blog/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>


  <script defer src="/blog/lib/three/three.min.js"></script>
    <script defer src="/blog/lib/three/three-waves.min.js"></script>


  















  

  

</body>
</html>
